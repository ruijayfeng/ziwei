# 紫微斗数 App (Zi Wei Dou Shu)

开源的紫微斗数命盘工具，精准排盘 + AI 深度解读，支持自部署和多模型切换。

> 设计方案：[docs/plans/2026-01-04-ziwei-app-design.md](docs/plans/2026-01-04-ziwei-app-design.md)

## 目录结构

```
zwds/
├── CLAUDE.md                    # 项目架构说明
├── 01-排盘算法/                  # [优先级:P0] 核心算法，建站必须
│   ├── 01-命宫身宫定位.md        # 命盘起点
│   ├── 02-五行局计算.md          # 纳音五行局
│   ├── 03-紫微星定位.md          # 紫微星核心算法
│   ├── 04-安星诀-主星.md         # 十四主星排布
│   ├── 05-安星诀-辅煞星.md       # 辅星煞星排布
│   └── 06-宫干五虎遁.md          # 天干排布
├── 02-星曜体系/                  # [优先级:P1] 星曜含义解读
│   ├── 01-十四主星.md            # 核心主星
│   ├── 02-六吉星.md              # 左右昌曲魁钺
│   ├── 03-六煞星.md              # 羊陀火铃空劫
│   └── 04-其他辅星.md            # 禄存天马等
├── 03-宫位系统/                  # [优先级:P1] 十二宫详解
│   └── 01-十二宫详解.md
├── 04-四化飞星/                  # [优先级:P1] 动态分析核心
│   ├── 01-四化基础.md
│   └── 02-十干四化表.md
├── 05-格局判断/                  # [优先级:P2] 命盘格局
│   └── 01-经典格局.md
├── 06-运限系统/                  # [优先级:P2] 大限流年
│   └── 01-大限流年.md
├── 99-参考资源/                  # 学习资源汇总
│   └── 01-资源汇总.md
└── docs/
    └── plans/                    # 设计文档
        └── 2026-01-04-ziwei-app-design.md
```

## 优先级说明

| 优先级 | 说明 | 状态 |
|--------|------|------|
| P0 | 排盘算法 - 无此无法生成命盘 | ✅ 完成 |
| P1 | 四化飞星 - 动态分析核心 | ✅ 完成 |
| P1 | 星曜/宫位 - 解盘基础 | ✅ 完成 |
| P2 | 格局/运限 - 高级分析 | ✅ 完成 |

## 开发依赖

建站时可直接使用的开源库：
- **JavaScript**: [iztro](https://github.com/SylarLong/iztro) - 最完善的紫微斗数排盘库
- **Python**: [ziweidoushu_lib](https://gitee.com/wuguiming/ziweidoushu_lib)

## 核心算法流程

```
输入: 阳历出生时间 + 性别
    ↓
[农历转换] 阳历 → 农历年月日时
    ↓
[定命宫] 寅起正月顺数月，逆数时辰
    ↓
[定身宫] 寅起正月顺数月，顺数时辰
    ↓
[定五行局] 命宫干支 → 纳音五行
    ↓
[定紫微星] 出生日 ÷ 局数 → 紫微位置
    ↓
[排主星] 紫微星系6颗 + 天府星系8颗
    ↓
[排辅煞星] 六吉六煞 + 其他辅星
    ↓
[定四化] 年干 → 化禄权科忌
    ↓
输出: 完整命盘
```

## 注意事项

- 紫微斗数使用**农历**（太阴历），非立春分界
- 闰月处理：前半月归上月，后半月归下月
- 子初换日：23:00 即换日（晚子时整体归属次日）
- 安星法：中州派（对齐文墨天机）
