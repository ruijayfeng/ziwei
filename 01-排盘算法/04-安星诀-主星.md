# 十四主星排布规则（安星诀）

## 概述

十四主星分为两个星系：
- **紫微星系**（6颗）：紫微、天机、太阳、武曲、天同、廉贞
- **天府星系**（8颗）：天府、太阴、贪狼、巨门、天相、天梁、七杀、破军

---

## 一、紫微星系（6颗）

### 排布口诀

> **紫微天机逆行旁，隔一阳武天同当，又隔二位廉贞地，空三复见紫微郎**

### 排布规则

从紫微星位置开始，**逆时针**排布：

```
紫微 → (逆1宫) → 天机 → (隔1宫) → 太阳 → (逆1宫) → 武曲 → (逆1宫) → 天同 → (隔2宫) → 廉贞
```

### 图示

```
假设紫微在午宫：

紫微(午) → 天机(巳) → [跳过辰] → 太阳(卯) → 武曲(寅) → 天同(丑) → [跳过子、亥] → 廉贞(戌)
```

### 代码实现

```python
def arrange_ziwei_series(ziwei_idx):
    """
    排布紫微星系六颗星
    ziwei_idx: 紫微星位置（0-11，寅=0）
    返回: {星名: 宫位索引}
    """
    stars = {}
    # 紫微
    stars['紫微'] = ziwei_idx

    # 天机：紫微逆1宫
    stars['天机'] = (ziwei_idx - 1 + 12) % 12

    # 太阳：天机逆2宫（隔1宫）
    stars['太阳'] = (stars['天机'] - 2 + 12) % 12

    # 武曲：太阳逆1宫
    stars['武曲'] = (stars['太阳'] - 1 + 12) % 12

    # 天同：武曲逆1宫
    stars['天同'] = (stars['武曲'] - 1 + 12) % 12

    # 廉贞：天同逆3宫（隔2宫）
    stars['廉贞'] = (stars['天同'] - 3 + 12) % 12

    return stars
```

---

## 二、天府星系（8颗）

### 排布口诀

> **天府太阴与贪狼，巨门天相及天梁，七杀空三破军位，八星顺数细推详**

### 排布规则

从天府星位置开始，**顺时针**排布：

```
天府 → (顺1宫) → 太阴 → (顺1宫) → 贪狼 → (顺1宫) → 巨门 → (顺1宫) → 天相 → (顺1宫) → 天梁 → (顺1宫) → 七杀 → (隔3宫) → 破军
```

### 图示

```
假设天府在申宫：

天府(申) → 太阴(酉) → 贪狼(戌) → 巨门(亥) → 天相(子) → 天梁(丑) → 七杀(寅) → [跳过卯辰巳] → 破军(午)
```

### 代码实现

```python
def arrange_tianfu_series(tianfu_idx):
    """
    排布天府星系八颗星
    tianfu_idx: 天府星位置（0-11，寅=0）
    返回: {星名: 宫位索引}
    """
    stars = {}
    # 天府
    stars['天府'] = tianfu_idx

    # 太阴：天府顺1宫
    stars['太阴'] = (tianfu_idx + 1) % 12

    # 贪狼：太阴顺1宫
    stars['贪狼'] = (stars['太阴'] + 1) % 12

    # 巨门：贪狼顺1宫
    stars['巨门'] = (stars['贪狼'] + 1) % 12

    # 天相：巨门顺1宫
    stars['天相'] = (stars['巨门'] + 1) % 12

    # 天梁：天相顺1宫
    stars['天梁'] = (stars['天相'] + 1) % 12

    # 七杀：天梁顺1宫
    stars['七杀'] = (stars['天梁'] + 1) % 12

    # 破军：七杀顺4宫（隔3宫）
    stars['破军'] = (stars['七杀'] + 4) % 12

    return stars
```

---

## 三、完整排布流程

```python
def arrange_14_main_stars(birth_day, ju_num):
    """
    排布十四主星
    birth_day: 出生日
    ju_num: 五行局数
    """
    # 1. 定紫微星位置
    ziwei_pos = get_ziwei_position(birth_day, ju_num)
    ziwei_idx = DIZHI_ORDER.index(ziwei_pos)

    # 2. 定天府星位置（紫府对称）
    tianfu_idx = (14 - (ziwei_idx + 1)) % 12
    if tianfu_idx == 0:
        tianfu_idx = 12

    # 3. 排紫微星系
    ziwei_stars = arrange_ziwei_series(ziwei_idx)

    # 4. 排天府星系
    tianfu_stars = arrange_tianfu_series(tianfu_idx - 1)  # 转为0-based

    # 5. 合并
    all_stars = {**ziwei_stars, **tianfu_stars}
    return all_stars
```

---

## 四、十四主星位置速查表

### 紫微星系排布表

| 紫微 | 天机 | 太阳 | 武曲 | 天同 | 廉贞 |
|------|------|------|------|------|------|
| 寅 | 丑 | 亥 | 戌 | 酉 | 午 |
| 卯 | 寅 | 子 | 亥 | 戌 | 未 |
| 辰 | 卯 | 丑 | 子 | 亥 | 申 |
| 巳 | 辰 | 寅 | 丑 | 子 | 酉 |
| 午 | 巳 | 卯 | 寅 | 丑 | 戌 |
| 未 | 午 | 辰 | 卯 | 寅 | 亥 |
| 申 | 未 | 巳 | 辰 | 卯 | 子 |
| 酉 | 申 | 午 | 巳 | 辰 | 丑 |
| 戌 | 酉 | 未 | 午 | 巳 | 寅 |
| 亥 | 戌 | 申 | 未 | 午 | 卯 |
| 子 | 亥 | 酉 | 申 | 未 | 辰 |
| 丑 | 子 | 戌 | 酉 | 申 | 巳 |

### 天府星系排布表

| 天府 | 太阴 | 贪狼 | 巨门 | 天相 | 天梁 | 七杀 | 破军 |
|------|------|------|------|------|------|------|------|
| 寅 | 卯 | 辰 | 巳 | 午 | 未 | 申 | 子 |
| 卯 | 辰 | 巳 | 午 | 未 | 申 | 酉 | 丑 |
| 辰 | 巳 | 午 | 未 | 申 | 酉 | 戌 | 寅 |
| 巳 | 午 | 未 | 申 | 酉 | 戌 | 亥 | 卯 |
| 午 | 未 | 申 | 酉 | 戌 | 亥 | 子 | 辰 |
| 未 | 申 | 酉 | 戌 | 亥 | 子 | 丑 | 巳 |
| 申 | 酉 | 戌 | 亥 | 子 | 丑 | 寅 | 午 |
| 酉 | 戌 | 亥 | 子 | 丑 | 寅 | 卯 | 未 |
| 戌 | 亥 | 子 | 丑 | 寅 | 卯 | 辰 | 申 |
| 亥 | 子 | 丑 | 寅 | 卯 | 辰 | 巳 | 酉 |
| 子 | 丑 | 寅 | 卯 | 辰 | 巳 | 午 | 戌 |
| 丑 | 寅 | 卯 | 辰 | 巳 | 午 | 未 | 亥 |

---

## 五、特殊同宫组合

### 必然同宫的组合

由于排布规则固定，某些星曜必然同宫：

| 组合 | 同宫位置 |
|------|---------|
| 紫微+天府 | 寅宫或申宫 |
| 紫微+贪狼 | 卯宫或酉宫 |
| 紫微+天相 | 辰宫或戌宫 |
| 紫微+七杀 | 巳宫或亥宫 |
| 紫微+破军 | 丑宫或未宫 |
| 武曲+天府 | 子宫或午宫 |
| 武曲+贪狼 | 丑宫或未宫 |
| ... | ... |

---

## 参考资源

- [紫微斗数安星诀，安14主星 - 豆瓣](https://www.douban.com/note/694189881/)
- [紫微斗数安星诀与排盘方法详解 - 紫微斗数学堂](http://www.ziweicn.com/show/3082.html)
- [十四主星 - 百度百科](https://baike.baidu.com/item/十四主星/991733)
