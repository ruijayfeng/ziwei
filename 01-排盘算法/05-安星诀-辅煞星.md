# 辅星煞星排布规则

## 概述

紫微斗数除十四主星外，还有众多辅星、煞星影响命盘解读。

### 星曜分类

| 类别 | 星曜 | 安星依据 |
|------|------|---------|
| 六吉星 | 左辅、右弼、文昌、文曲、天魁、天钺 | 月/时/年 |
| 六煞星 | 擎羊、陀罗、火星、铃星、地空、地劫 | 年/时 |
| 禄马星 | 禄存、天马 | 年 |

---

## 一、左辅右弼（月系星）

### 安星口诀

> **辰上起正月，顺数左辅至；戌上起正月，逆数右弼止**

### 安星规则

| 星曜 | 起点 | 方向 | 依据 |
|------|------|------|------|
| 左辅 | 辰宫 | 顺时针 | 农历月份 |
| 右弼 | 戌宫 | 逆时针 | 农历月份 |

### 左辅右弼位置表

| 月份 | 左辅 | 右弼 |
|------|------|------|
| 正月 | 辰 | 戌 |
| 二月 | 巳 | 酉 |
| 三月 | 午 | 申 |
| 四月 | 未 | 未 |
| 五月 | 申 | 午 |
| 六月 | 酉 | 巳 |
| 七月 | 戌 | 辰 |
| 八月 | 亥 | 卯 |
| 九月 | 子 | 寅 |
| 十月 | 丑 | 丑 |
| 十一月 | 寅 | 子 |
| 十二月 | 卯 | 亥 |

**特殊情况**：四月、十月左辅右弼同宫

### 代码实现

```python
def get_zuofu_youbi(month):
    """
    month: 农历月份 1-12
    """
    # 左辅：辰=4，顺时针
    zuofu_idx = (4 + month - 1) % 12
    # 右弼：戌=10，逆时针
    youbi_idx = (10 - month + 1 + 12) % 12
    return DIZHI[zuofu_idx], DIZHI[youbi_idx]
```

---

## 二、文昌文曲（时系星）

### 安星口诀

> **子时戌上起文昌，逆到生时是贵乡**
> **文曲数从辰上起，顺到生时是本乡**

### 安星规则

| 星曜 | 起点 | 方向 | 依据 |
|------|------|------|------|
| 文昌 | 戌宫 | 逆时针 | 出生时辰 |
| 文曲 | 辰宫 | 顺时针 | 出生时辰 |

### 文昌文曲位置表

| 时辰 | 文昌 | 文曲 |
|------|------|------|
| 子 | 戌 | 辰 |
| 丑 | 酉 | 巳 |
| 寅 | 申 | 午 |
| 卯 | 未 | 未 |
| 辰 | 午 | 申 |
| 巳 | 巳 | 酉 |
| 午 | 辰 | 戌 |
| 未 | 卯 | 亥 |
| 申 | 寅 | 子 |
| 酉 | 丑 | 丑 |
| 戌 | 子 | 寅 |
| 亥 | 亥 | 卯 |

**特殊情况**：卯时、酉时文昌文曲同宫（未宫、丑宫）

### 代码实现

```python
def get_wenchang_wenqu(hour):
    """
    hour: 时辰索引 0-11 (子=0, 丑=1, ...)
    """
    # 文昌：戌=10，逆时针
    wenchang_idx = (10 - hour + 12) % 12
    # 文曲：辰=4，顺时针
    wenqu_idx = (4 + hour) % 12
    return DIZHI[wenchang_idx], DIZHI[wenqu_idx]
```

---

## 三、天魁天钺（年系星）

### 安星规则

天魁天钺根据**年干**安星，与八字天乙贵人排法相同。

### 天魁天钺位置表

| 年干 | 天魁 | 天钺 |
|------|------|------|
| 甲 | 丑 | 未 |
| 乙 | 子 | 申 |
| 丙 | 亥 | 酉 |
| 丁 | 亥 | 酉 |
| 戊 | 丑 | 未 |
| 己 | 子 | 申 |
| 庚 | 丑 | 未 |
| 辛 | 午 | 寅 |
| 壬 | 卯 | 巳 |
| 癸 | 卯 | 巳 |

### 口诀记忆

> **甲戊庚牛羊（丑未），乙己鼠猴乡（子申）**
> **丙丁猪鸡位（亥酉），壬癸兔蛇藏（卯巳）**
> **六辛逢马虎（午寅），此是贵人方**

### 代码实现

```python
KUIYUE_TABLE = {
    '甲': ('丑', '未'), '乙': ('子', '申'), '丙': ('亥', '酉'),
    '丁': ('亥', '酉'), '戊': ('丑', '未'), '己': ('子', '申'),
    '庚': ('丑', '未'), '辛': ('午', '寅'), '壬': ('卯', '巳'),
    '癸': ('卯', '巳')
}

def get_kuiyue(year_gan):
    return KUIYUE_TABLE[year_gan]
```

### 重要特性

- 天魁为**昼贵人**（阳贵），利于白天生人
- 天钺为**夜贵人**（阴贵），利于夜晚生人
- 魁钺**不入辰戌二宫**

---

## 四、禄存、擎羊、陀罗（年系星）

### 安星口诀

禄存：
> **甲禄在寅乙禄卯，丙戊在巳丁己午**
> **庚禄居申辛禄酉，壬禄居亥癸禄子**

羊陀规则：
> **擎羊在禄存顺前一宫，陀罗在禄存逆后一宫**

### 禄存擎羊陀罗位置表

| 年干 | 禄存 | 擎羊 | 陀罗 |
|------|------|------|------|
| 甲 | 寅 | 卯 | 丑 |
| 乙 | 卯 | 辰 | 寅 |
| 丙 | 巳 | 午 | 辰 |
| 丁 | 午 | 未 | 巳 |
| 戊 | 巳 | 午 | 辰 |
| 己 | 午 | 未 | 巳 |
| 庚 | 申 | 酉 | 未 |
| 辛 | 酉 | 戌 | 申 |
| 壬 | 亥 | 子 | 戌 |
| 癸 | 子 | 丑 | 亥 |

### 代码实现

```python
LUCUN_TABLE = {
    '甲': '寅', '乙': '卯', '丙': '巳', '丁': '午', '戊': '巳',
    '己': '午', '庚': '申', '辛': '酉', '壬': '亥', '癸': '子'
}

def get_lucun_yangtuo(year_gan):
    lucun = LUCUN_TABLE[year_gan]
    lucun_idx = DIZHI.index(lucun)
    qingyang = DIZHI[(lucun_idx + 1) % 12]  # 顺前一宫
    tuoluo = DIZHI[(lucun_idx - 1 + 12) % 12]  # 逆后一宫
    return lucun, qingyang, tuoluo
```

### 羊陀夹命

禄存在命宫时，擎羊陀罗必夹命宫两侧，称"羊陀夹命"，不利格局。

---

## 五、火星铃星（年支+时支）

### 安星规则

火星铃星需要**年支**和**时支**共同确定。

### 火星起点表

| 年支 | 火星起点 |
|------|---------|
| 寅午戌 | 丑宫起子时 |
| 申子辰 | 寅宫起子时 |
| 巳酉丑 | 卯宫起子时 |
| 亥卯未 | 酉宫起子时 |

从起点顺数至出生时辰，即为火星位置。

### 铃星起点表

| 年支 | 铃星起点 |
|------|---------|
| 寅午戌 | 卯宫起子时 |
| 申子辰 | 戌宫起子时 |
| 巳酉丑 | 戌宫起子时 |
| 亥卯未 | 戌宫起子时 |

从起点顺数至出生时辰，即为铃星位置。

---

## 六、地空地劫（时系星）

### 安星口诀

> **亥上起子时，顺数地劫至**
> **亥上起子时，逆数地空至**

### 地空地劫位置表

| 时辰 | 地劫 | 地空 |
|------|------|------|
| 子 | 亥 | 亥 |
| 丑 | 子 | 戌 |
| 寅 | 丑 | 酉 |
| 卯 | 寅 | 申 |
| 辰 | 卯 | 未 |
| 巳 | 辰 | 午 |
| 午 | 巳 | 巳 |
| 未 | 午 | 辰 |
| 申 | 未 | 卯 |
| 酉 | 申 | 寅 |
| 戌 | 酉 | 丑 |
| 亥 | 戌 | 子 |

### 代码实现

```python
def get_dikong_dijie(hour):
    """
    hour: 时辰索引 0-11 (子=0)
    """
    # 地劫：亥=11，顺时针
    dijie_idx = (11 + hour) % 12
    # 地空：亥=11，逆时针
    dikong_idx = (11 - hour + 12) % 12
    return DIZHI[dikong_idx], DIZHI[dijie_idx]
```

---

## 参考资源

- [排盘第三步安六吉六凶 - 紫微取象派](https://www.ziweishuyuan.com/ziwei-place/place-way/575.html)
- [紫微斗数六煞星：擎羊星，陀罗星 - 知乎](https://zhuanlan.zhihu.com/p/570239592)
- [刘韫龄讲文昌文曲 - 紫微取象派](https://www.ziweishuyuan.com/express-method/471.html)
- [紫微斗数算法的实现流程 - 博客园](https://www.cnblogs.com/voidobject/p/18510346)
